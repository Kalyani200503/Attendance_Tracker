<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Attendance Tracker</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>Attendance Tracker</h2>

<!-- Add Student Form -->
<div style="margin-bottom: 20px;">
  <input type="text" id="studentNameInput" placeholder="Enter student name" />
  <button onclick="addStudent()">Add Student</button>
</div>

<!-- Attendance Table -->
<table id="attendanceTable">
  <thead>
    <tr id="row">
      <th>List of Students</th>
    
      <th>23/05/2025</th>
      <th>24/05/2025</th>
      <th>25/05/2025</th>
      <th>26/05/2025</th>
      <th>27/05/2025</th>
     
      
      <th>Monthly %</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="tableBody">
    <!-- Rows will be added by JS -->
  </tbody>
</table>

<script>
  const students = ["kalyani", "Rubina", "Vyshnavi", "Chetana","Pranitha","Tejaswini","Pooja"];
  const dates = ["Date 1", "Date 2", "Date 3", "Date 4","Date 5"];
  const tableBody = document.getElementById("tableBody");

  function createInput(cell, studentIndex) {
    const input = document.createElement("input");
    input.maxLength = 1;
    input.style.width = "30px";
    input.addEventListener("input", () => {
      const value = input.value.toUpperCase();
      input.value = value;

      // Set color
      input.className = "";
      if (value === "P") input.classList.add("present");
      else if (value === "A") input.classList.add("absent");
      else if (value === "Y") input.classList.add("late");

      calculatePercentage(studentIndex);
    });
    cell.appendChild(input);
  }

  function calculatePercentage(studentIndex) {
    const row = tableBody.children[studentIndex];
    let presentCount = 0;
    let total = dates.length;

    for (let i = 1; i <= dates.length; i++) {
      const input = row.cells[i].querySelector("input");
      if (input) {
        const val = input.value.toUpperCase();
        if (val === "P" || val === "Y") {
          presentCount++;
        }
      }
    }

    const percentCell = row.cells[dates.length + 1];
    const percentage = ((presentCount / total) * 100).toFixed(0);
    percentCell.textContent = `${percentage}% (${presentCount} / ${total})`;
  }

  function renderStudent(name) {
    const row = tableBody.insertRow();
    const index = tableBody.rows.length - 1;

    row.insertCell().textContent = name;

    for (let i = 0; i < dates.length; i++) {
      createInput(row.insertCell(), index);
    }

    row.insertCell().textContent = "0% (0 / " + dates.length + ")"; // Percentage cell

    // Action Cell
    const actionCell = row.insertCell();
    const deleteBtn = document.createElement("button");
    deleteBtn.textContent = "Delete";
    deleteBtn.className = "delete-btn";
    deleteBtn.onclick = () => {
      tableBody.deleteRow(index);
      updateAllPercentages(); // Recalculate after deletion
    };
    actionCell.appendChild(deleteBtn);
  }

  function addStudent() {
    const nameInput = document.getElementById("studentNameInput");
    const name = nameInput.value.trim();
    if (name) {
      students.push(name);
      renderStudent(name);
      nameInput.value = "";
    } else {
      alert("Please enter a valid student name.");
    }
  }

  function updateAllPercentages() {
    for (let i = 0; i < tableBody.rows.length; i++) {
      calculatePercentage(i);
    }
  }

  // Initial render
  students.forEach(renderStudent);
</script>

</body>
</html>
